<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Dashboard | Medical Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="assets/css/doctorDashbord.css">



</head>
<body>
    <div class="dashboard-wrapper">

            <div id="dashbord_box"></div>

      
            <div class="main-content">

            <div id="header_box"></div>
           
            <div class="container-fluid p-4">
                <!-- Stats Row -->
                <div class="row">
                    <div class="col-md-3">
                        <div class="dashboard-card">
                            <div class="stat-card">
                                <div class="stat-icon appointments">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="stat-number">18</div>
                                <div class="stat-label">Today's Appointments</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="dashboard-card">
                            <div class="stat-card">
                                <div class="stat-icon patients">
                                    <i class="fas fa-user-injured"></i>
                                </div>
                                <div class="stat-number">1,240</div>
                                <div class="stat-label">Total Patients</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="dashboard-card">
                            <div class="stat-card">
                                <div class="stat-icon earnings">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                                <div class="stat-number">$8,540</div>
                                <div class="stat-label">Monthly Earnings</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="dashboard-card">
                            <div class="stat-card">
                                <div class="stat-icon rating">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="stat-number">4.8</div>
                                <div class="stat-label">Average Rating</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <!-- Appointments -->
                    <div class="col-lg-12">
                        <div class="dashboard-card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span>Today's Appointments</span>
                                <a href="#" class="btn btn-sm btn-primary">View All</a>
                            </div>
                            <div class="card-body p-0">
                                <div class="appointment-item d-flex align-items-center">
                                    <img src="" 
                                    class="patient-img me-3" alt="Patient">
                                    <div class="flex-grow-1">
                                        <h6 class="mb-0">John Doe</h6>
                                        <small class="text-muted">Regular Checkup</small>
                                    </div>
                                    <div class="text-end">
                                        <div class="appointment-time mb-1">10:00 AM</div>
                                        <span class="status-badge status-confirmed">Confirmed</span>
                                    </div>
                                </div>
                        
                                <div class="appointment-item d-flex align-items-center">
                                    <img src="https://ui-avatars.com/api/?name=Michael+Taylor&background=random" class="patient-img me-3" alt="Patient">
                                    <div class="flex-grow-1">
                                        <h6 class="mb-0">Michael Taylor</h6>
                                        <small class="text-muted">General Consultation</small>
                                    </div>
                                    <div class="text-end">
                                        <div class="appointment-time mb-1">4:30 PM</div>
                                        <span class="status-badge status-cancelled">Cancelled</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Patient Statistics -->
           
                </div>
            </div>
        </div>
    </div>




    <!-- <p><b>Token:</b> <span id="token"></span></p>

    <pre id="err" style="color:red;"></pre> -->



    <script src="assets/js/docotorDashbord.js"></script>

    <script>

     
        function logoutDoctor() {
    sessionStorage.clear(); 
    window.location.href = "login.html";
}

async function loadDoctorProfile() {
    const token = sessionStorage.getItem("token");
    const role = sessionStorage.getItem("role");
    const username = sessionStorage.getItem("username");
    const id = sessionStorage.getItem("id");
    console.log(token);

    if (!token) {
        window.location.href = "login.html";
        return;
    }

    if (role != 1) {
        document.getElementById("err").innerText = "Access denied!";
        return;
    }


    try {
        const response = await fetch("http://localhost:8080/api/doctors/profile", {
            method: "GET",
            headers: { "Authorization": "Bearer " + token }
        });

        if (!response.ok) throw new Error("Failed to fetch doctor profile");

         
        const data = await response.json();
        console.log("Doctor Profile:", data);


          if (data.profilePicture) {
            document.getElementById("doctorImage").src =
                "data:image/png;base64," + data.profilePicture;
        }

        // load the data 

        const firstName=document.getElementById("firstName");
        const lastName=document.getElementById("lastName");
        const specialty=document.getElementById("specialty");

        firstName.innerText=data.firstName;
        lastName.innerText=data.lastName;
        specialty.innerText=data.specialty;

    } catch (err) {
        console.error("Error:", err.message);
        document.getElementById("err").innerText = err.message;
    }
}

loadDoctorProfile();

    </script>

</body>
</html>